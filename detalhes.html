<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meu Dividendo - Pesquisa de Ativos</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f5f5f5; color:#333; }
  header { background:#000; color:#fff; padding:16px; text-align:center; font-size:1.4em; }
  #searchContainer { text-align:center; margin:20px; }
  #searchInput { padding:8px; font-size:1em; width:220px; }
  #cards { display:flex; flex-wrap:wrap; gap:12px; justify-content:center; margin:20px; }
  .card { background:#000; color:#fff; padding:16px 24px; border-radius:12px; min-width:180px; text-align:left; box-shadow:0 4px 8px rgba(0,0,0,0.2); }
  .card.fii { background:#2c3e50; } 
  .card h3 { margin:0 0 8px 0; font-size:1.1em; text-align:center; }
  .card p { margin:2px 0; font-size:0.9em; }
</style>
</head>
<body>

<header>Meu Dividendo - Pesquisa de Ativos</header>

<div id="searchContainer">
  <input type="text" id="searchInput" placeholder="Digite o código do ativo (ex: VALE3, MXRF11)">
  <button onclick="buscarAtivo()">Buscar</button>
</div>

<div id="cards"></div>

<script>
let acoes = [];
let fiis = [];

// Carrega os JSONs gerados pelo scraper
fetch('acoes_fundamentus.json')
  .then(res => res.json())
  .then(data => acoes = data)
  .catch(err => console.error("Erro ao carregar acoes.json:", err));

fetch('fiis_fundamentus.json')
  .then(res => res.json())
  .then(data => fiis = data)
  .catch(err => console.error("Erro ao carregar fiis.json:", err));

function buscarAtivo() {
  const query = document.getElementById('searchInput').value.trim().toUpperCase();
  const cardsDiv = document.getElementById('cards');
  cardsDiv.innerHTML = '';

  if(!query) return alert("Digite um ativo!");

  // Função que normaliza o campo 'papel'
  const encontrarAtivo = arr => arr.find(a => (a.papel || a.Papel || "").toString().trim().toUpperCase() === query);

  let ativo = encontrarAtivo(acoes);
  let tipo = "Ação";

  if(!ativo) {
    ativo = encontrarAtivo(fiis);
    tipo = "FII";
  }

  if(!ativo) return alert("Ativo não encontrado!");

  const div = document.createElement('div');
  div.className = 'card' + (tipo === "FII" ? " fii" : "");
  div.innerHTML = `<h3>${ativo.papel || ativo.Papel} (${tipo})</h3>`;

  Object.keys(ativo).forEach(k => {
    div.innerHTML += `<p><strong>${k}</strong>: ${ativo[k]}</p>`;
  });

  cardsDiv.appendChild(div);
}
</script>

</body>
</html>