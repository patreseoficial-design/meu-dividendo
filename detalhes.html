<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detalhes do Ativo</title>

  <!-- CSS externo -->
  <link rel="stylesheet" href="style.css">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- CSS interno -->
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f5f5f5; color:#333; }
    header { background:#000; color:#fff; padding:16px; text-align:center; font-size:1.2em; }
    #nomeAtivo { text-align:center; margin:24px 0; font-size:2em; font-weight:bold; }
#cards {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
  margin-bottom: 24px;
}

.card {
  background: #000;
  color: #fff;
  padding: 16px 24px;
  border-radius: 12px;
  flex: 1 1 calc(50% - 12px); /* cada card ocupa metade da linha menos o gap */
  text-align: center;
  min-width: 200px; /* evita que fique muito pequeno em telas pequenas */
  box-sizing: border-box;
}

    .section { margin:20px; background:#fff; padding:16px; border-radius:12px; }
    table { width:100%; border-collapse:collapse; margin-top:12px; }
    th, td { padding:8px; border:1px solid #ccc; text-align:center; }
    th { background:#eee; }
    canvas { max-width:100%; }

    /* ===== MENU HAMB√öRGUER NA ESQUERDA ===== */
    .menu-links {
      position: fixed;
      top: 0;
      left: 0;               
      width: 250px;
      height: 100%;
      background-color: #000;
      color: #fff;
      padding-top: 60px;
      display: none;
      flex-direction: column;
      z-index: 1000;
    }

    .menu-links ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .menu-links li {
      margin: 16px 0;
    }

    .menu-links a {
      color: #fff;
      text-decoration: none;
      font-size: 1.1em;
      padding: 8px 16px;
      display: block;
    }
  </style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="menu" onclick="toggleMenu()">‚ò∞</div>
  <h1>Meu Dividendo</h1>
  <div class="profile"></div>

  <!-- MENU HAMB√öRGUER -->
  <nav id="menuLinks" class="menu-links" style="display:none;">
    <ul>
      <li><a href="index.html">üè† In√≠cio</a></li>
      <li><a href="calculadora.html">Calculadora de juros compostos</a></li>
      <li><a href="calculadora-rescisao.html">Calculadora de rescis√£o</a></li>
      <li><a href="calculadora-13salario.html">Calculadora de 13¬∫ Sal√°rio</a></li>
      <li><a href="calculadora-ir.html">Calculadora imposto de renda sobre Investimentos</a></li>
      <li><a href="quanto-investir-por-mes.html">Quanto investir por m√™s</a></li>
      <li><a href="calculadora-pis.html">Calculadora do PIS</a></li>
      <li><a href="calculadora-quitacao.html">Calculadora de quita√ß√£o patrimonial</a></li>
    </ul>
  </nav>
</header>

<!-- SCRIPT MENU -->
<script>
  function toggleMenu() {
    const menu = document.getElementById('menuLinks');
    menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
  }
</script>

<!-- Nome do ativo -->
<div id="nomeAtivo">Ativo</div>

<!-- Aqui voc√™ vai colocar depois os cards e a imagem clic√°vel -->
<!-- Cards principais -->
<div id="cards">
  <!-- Os cards ser√£o preenchidos dinamicamente via JS -->
</div>

<!-- Imagem clic√°vel -->
<div style="text-align:center; margin: 30px 0;">
  <a href="calculadora.html">
    <img 
      src="imagens/bannerjuroscompostos.png"
      alt="Usar parte do PIS para investir e construir patrim√¥nio"
      width="800"
      height="450"
      style="max-width:100%; height:auto; border-radius:12px;"
      loading="lazy"
    >
  </a>
</div>

<!-- Gr√°ficos -->
<div class="section">
  <h3>Hist√≥rico de Pre√ßos</h3>
  <canvas id="precoChart"></canvas>
</div>

<!-- Dividendos -->
<div class="section">
  <h3>Dividendos / Rendimentos</h3>
  <table id="dividendosTable">
    <thead>
      <tr><th>Data Base</th><th>Data Pagamento</th><th>Rendimento</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- Indicadores -->
<div class="section">
  <h3>Indicadores Financeiros</h3>
  <div id="indicadores" style="display:flex; flex-wrap:wrap; gap:12px;"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Pega a nomenclatura do ativo na URL
const params = new URLSearchParams(window.location.search);
const ativo = params.get("ativo");

if(!ativo) {
  alert("Nenhum ativo informado!");
} else {
  document.getElementById("nomeAtivo").textContent = ativo;

  // 1Ô∏è‚É£ Buscar dados do ativo
  fetch(`https://brapi.dev/api/quote/${ativo}?token=kfWwE93iiUiHTg5V4XjbYR`)
    .then(res => res.json())
    .then(data => {
      const stock = data.results[0];
      if(!stock) { alert("Ativo n√£o encontrado."); return; }

   // Preencher cards principais
const cardsDiv = document.getElementById("cards");
const cardsInfo = [
  {label:"Pre√ßo", value:`R$ ${stock.regularMarketPrice}`},
  {label:"Varia√ß√£o", value:`${stock.regularMarketChangePercent}%`},
  {label:"M√°x/M√≠n", value:`R$ ${stock.regularMarketDayHigh} / R$ ${stock.regularMarketDayLow}`},
  {label:"Volume", value:stock.regularMarketVolume || "N/A"}
];
cardsInfo.forEach(i => {
  const card = document.createElement("div");
  card.className = "card";
  card.innerHTML = `<strong>${i.label}</strong><br>${i.value}`;
  cardsDiv.appendChild(card);
});

      // 3Ô∏è‚É£ Hist√≥rico de pre√ßos (gr√°fico)
      fetch(`https://brapi.dev/api/quote/${ativo}/chart?interval=1d&range=1y&token=kfWwE93iiUiHTg5V4XjbYR`)
        .then(res => res.json())
        .then(chartData => {
          const datas = chartData.results.map(d=>d.date);
          const precos = chartData.results.map(d=>d.close);
          const ctx = document.getElementById('precoChart').getContext('2d');
          new Chart(ctx, {
            type:'line',
            data:{ labels: datas, datasets:[{ label:'Pre√ßo', data:precos, borderColor:'#007bff', backgroundColor:'rgba(0,123,255,0.1)' }] },
            options:{ responsive:true, plugins:{ legend:{display:true}, tooltip:{mode:'index'} } }
          });
        });

      // 4Ô∏è‚É£ Dividendos
      fetch(`https://brapi.dev/api/stock/dividends?symbol=${ativo}&token=kfWwE93iiUiHTg5V4XjbYR`)
        .then(res => res.json())
        .then(divData => {
          const tbody = document.querySelector("#dividendosTable tbody");
          divData.results.forEach(div => {
            const tr = document.createElement("tr");
            tr.innerHTML = `<td>${div.exDate}</td><td>${div.payDate}</td><td>R$ ${div.amount}</td>`;
            tbody.appendChild(tr);
          });
        });

      // 5Ô∏è‚É£ Indicadores financeiros
      fetch(`https://brapi.dev/api/stock/financials?symbol=${ativo}&token=kfWwE93iiUiHTg5V4XjbYR`)
        .then(res => res.json())
        .then(finData => {
          const indicadoresDiv = document.getElementById("indicadores");
          if(finData.results && finData.results.length > 0){
            const f = finData.results[0];
            const indicadores = [
              {label:"P/L", value:f.priceEarnings || "N/A"},
              {label:"P/VP", value:f.priceBook || "N/A"},
              {label:"Dividend Yield", value:f.dividendYield || "N/A"},
              {label:"Patrim√¥nio L√≠quido", value:f.totalEquity || "N/A"},
              {label:"Valor de Mercado", value:f.marketCap || "N/A"}
            ];
            indicadores.forEach(ind => {
              const card = document.createElement("div");
              card.className = "card";
              card.innerHTML = `<strong>${ind.label}</strong><br>${ind.value}`;
              indicadoresDiv.appendChild(card);
            });
          }
        });

    })
    .catch(err => { console.error(err); alert("Erro ao buscar informa√ß√µes do ativo."); });
}
</script>

</body>
</html>