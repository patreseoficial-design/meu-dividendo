<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Ativo | Cota칞칚o, Gr치fico e Indicadores | Meu Dividendo</title>

<meta name="description" content="Veja cota칞칚o, gr치fico, dividendos e indicadores financeiros do ativo na B3. Dados atualizados automaticamente.">
<meta name="robots" content="index, follow">

<link rel="canonical" href="https://meudividendo.online/detalhes.html">

<!-- CSS GLOBAL -->
<link rel="stylesheet" href="css/global.css">
<link rel="stylesheet" href="css/calculadora.css">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body { font-family: Arial, sans-serif; margin:0; background:#f5f5f5; color:#333; }
header { background:#000; color:#fff; padding:16px; text-align:center; }
header a { color:#fff; text-decoration:none; font-size:1.2em; }

.search-box {
  margin-top: 12px;
  display: flex;
  justify-content: center;
  gap: 8px;
}

.search-box input {
  padding: 8px;
  width: 180px;
}

.search-box button {
  padding: 8px 16px;
  cursor: pointer;
}

#nomeAtivo { text-align:center; margin:24px 0; font-size:2em; font-weight:bold; }

#cards {
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  justify-content:center;
  margin-bottom:24px;
}

.card {
  background:#000;
  color:#fff;
  padding:16px 24px;
  border-radius:12px;
  flex:1 1 140px;
  text-align:center;
  min-width:140px;
}

.section {
  margin:20px;
  background:#fff;
  padding:16px;
  border-radius:12px;
}

table {
  width:100%;
  border-collapse:collapse;
  margin-top:12px;
}

th, td {
  padding:8px;
  border:1px solid #ccc;
  text-align:center;
}

th { background:#eee; }

canvas { max-width:100%; }
</style>
</head>

<body>

<header>
  <a href="./index.html">Meu Dividendo</a>

  <!-- 游댍 BARRA DE PESQUISA SEO -->
  <form action="detalhes.html" method="GET" class="search-box">
    <input type="text" name="ativo" placeholder="Digite o ticker (ex: VALE3)" required>
    <button type="submit">Buscar</button>
  </form>
</header>

<div id="nomeAtivo">Ativo</div>

<!-- CARDS -->
<div id="cards"></div>

<!-- 游댳 ADSENSE TOPO -->
<div class="section" style="text-align:center;">
  <!-- Adsense topo -->
</div>

<!-- GR츼FICO -->
<div class="section">
  <h3>Hist칩rico de Pre칞os</h3>
  <canvas id="precoChart"></canvas>
</div>

<!-- 游댳 ADSENSE MEIO -->
<div class="section" style="text-align:center;">
  <!-- Adsense in-article -->
</div>

<!-- DIVIDENDOS -->
<div class="section">
  <h3>Dividendos</h3>
  <table id="dividendosTable">
    <thead>
      <tr>
        <th>Data Base</th>
        <th>Data Pagamento</th>
        <th>Valor</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- INDICADORES -->
<div class="section">
  <h3>Indicadores Financeiros</h3>
  <div id="indicadores" style="display:flex; flex-wrap:wrap; gap:12px;"></div>
</div>

<script>
const params = new URLSearchParams(window.location.search);
const ativo = params.get("ativo");

if (!ativo) {
  document.getElementById("nomeAtivo").textContent = "Nenhum ativo informado";
} else {

  const TICKER = ativo.toUpperCase();
  const TOKEN = "kfWwE93iiUiHTg5V4XjbYR"; // BRAPI

  document.getElementById("nomeAtivo").textContent = TICKER;
  document.title = `${TICKER} | Cota칞칚o, Gr치fico e Indicadores - Meu Dividendo`;

  // ===== COTA칂츾O =====
  fetch(`https://brapi.dev/api/quote/${TICKER}?token=${TOKEN}`)
    .then(res => res.json())
    .then(data => {
      const s = data.results?.[0];
      if (!s) return;

      const cards = [
        { label: "Pre칞o", value: `R$ ${s.regularMarketPrice}` },
        { label: "Varia칞칚o", value: `${s.regularMarketChangePercent}%` },
        { label: "M치x / M칤n", value: `R$ ${s.regularMarketDayHigh} / ${s.regularMarketDayLow}` },
        { label: "Volume", value: s.regularMarketVolume || "N/A" }
      ];

      const cardsDiv = document.getElementById("cards");
      cardsDiv.innerHTML = "";

      cards.forEach(c => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `<strong>${c.label}</strong><br>${c.value}`;
        cardsDiv.appendChild(div);
      });
    });

  // ===== GR츼FICO =====
  fetch(`https://brapi.dev/api/quote/${TICKER}/chart?interval=1d&range=1y&token=${TOKEN}`)
    .then(res => res.json())
    .then(chart => {
      const r = chart.results || [];
      const labels = r.map(i => i.date);
      const prices = r.map(i => i.close);

      new Chart(document.getElementById("precoChart"), {
        type: "line",
        data: {
          labels,
          datasets: [{
            label: "Pre칞o",
            data: prices,
            borderWidth: 2,
            fill: true
          }]
        },
        options: { responsive: true }
      });
    });

  // ===== DIVIDENDOS =====
  fetch(`https://brapi.dev/api/stock/dividends?symbol=${TICKER}&token=${TOKEN}`)
    .then(res => res.json())
    .then(div => {
      const tbody = document.querySelector("#dividendosTable tbody");
      tbody.innerHTML = "";
      div.results?.forEach(d => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${d.exDate}</td><td>${d.payDate}</td><td>R$ ${d.amount}</td>`;
        tbody.appendChild(tr);
      });
    });

  // ===== INDICADORES =====
  fetch(`https://brapi.dev/api/stock/financials?symbol=${TICKER}&token=${TOKEN}`)
    .then(res => res.json())
    .then(fin => {
      const f = fin.results?.[0];
      if (!f) return;

      const indicadores = [
        { label: "P/L", value: f.priceEarnings },
        { label: "P/VP", value: f.priceBook },
        { label: "Dividend Yield", value: f.dividendYield },
        { label: "Valor de Mercado", value: f.marketCap }
      ];

      const box = document.getElementById("indicadores");
      box.innerHTML = "";

      indicadores.forEach(i => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `<strong>${i.label}</strong><br>${i.value || "N/A"}`;
        box.appendChild(div);
      });
    });
}
</script>

</body>
</html>