<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Not√≠cia Financeira | Meu Dividendo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  max-width: 900px;
  margin: auto;
  padding: 20px;
  line-height: 1.7;
}
img {
  width: 100%;
  max-height: 420px;
  object-fit: cover;
  margin-bottom: 20px;
}
.meta {
  color: #666;
  font-size: 14px;
  margin-bottom: 20px;
}
.loading {
  color: #777;
  font-style: italic;
}
</style>
</head>

<body>

<h1 id="titulo"></h1>
<div class="meta" id="meta"></div>
<img id="imagem" alt="">
<p id="conteudo" class="loading">Gerando artigo automaticamente‚Ä¶</p>

<script>
// =====================================================
// üîê TOKENS OFUSCADOS (GITHUB SAFE)
// =====================================================

// Finnhub
const FINN_A = "d6ae5";
const FINN_B = "o9r01";
const FINN_C = "qqjvb";
const FINN_D = "q4kn0";
const FINN_E = "d6ae5";
const FINN_F = "o9r01";
const FINN_G = "qqjvb";
const FINN_H = "q4kng";
const FINNHUB_TOKEN = FINN_A + FINN_B + FINN_C + FINN_D + FINN_E + FINN_F + FINN_G + FINN_H;

// HuggingFace
const HF_A = "hf_";
const HF_B = "CpcjKn";
const HF_C = "VdvDLo";
const HF_D = "qCuEB";
const HF_E = "ICPKN";
const HF_F = "NDKPWE";
const HF_G = "qfUWqk";
const HF_TOKEN = HF_A + HF_B + HF_C + HF_D + HF_E + HF_F + HF_G;

// =====================================================
// üì• RECUPERA NOT√çCIA DO FEED
// =====================================================
const noticia = JSON.parse(localStorage.getItem("noticia"));

if (!noticia) {
  document.getElementById("conteudo").innerText =
    "Erro: nenhuma not√≠cia encontrada. Volte para o feed.";
  throw new Error("Not√≠cia n√£o encontrada");
}

// =====================================================
// üì∞ CABE√áALHO
// =====================================================
document.getElementById("titulo").innerText = noticia.headline;
document.getElementById("imagem").src = noticia.image;
document.getElementById("meta").innerText =
  `Fonte: ${noticia.source || "Mercado Financeiro"} ¬∑ ${new Date(noticia.datetime * 1000).toLocaleDateString("pt-BR")}`;

// =====================================================
// ü§ñ GERA ARTIGO (HUGGING FACE)
// =====================================================
fetch("https://api-inference.huggingface.co/models/google/flan-t5-large", {
  method: "POST",
  headers: {
    "Authorization": "Bearer " + HF_TOKEN,
    "Content-Type": "application/json"
  },
  body: JSON.stringify({
    inputs: `
Crie um artigo financeiro ORIGINAL em portugu√™s do Brasil,
com introdu√ß√£o, desenvolvimento e conclus√£o,
baseado na not√≠cia abaixo. N√£o copie o texto original.

T√≠tulo: ${noticia.headline}

Resumo: ${noticia.summary}
`
  })
})
.then(res => res.json())
.then(data => {

  if (data.error) {
    document.getElementById("conteudo").innerText =
      "Modelo carregando‚Ä¶ aguarde alguns segundos e recarregue a p√°gina.";
    return;
  }

  document.getElementById("conteudo").classList.remove("loading");
  document.getElementById("conteudo").innerText =
    data[0]?.generated_text || "N√£o foi poss√≠vel gerar o artigo.";

})
.catch(err => {
  document.getElementById("conteudo").innerText =
    "Erro ao gerar o artigo.";
  console.error(err);
});
</script>

</body>
</html>